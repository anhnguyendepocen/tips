---
title: "Windows Tips"
author: "J. R. Minter"
date: "Started: 2013-07-16, Last modified: 2019-02-19"
output:
  html_document:
    css: ../theme/jm-gray-vignette.css
    number_sections: yes
    toc: yes
    toc_depth: 3
---

[Back to Index](../README.html)

Some useful tips for windows

# SHA2 support required for Win7 after July 2019

From [slashdot](https://tech.slashdot.org/story/19/02/19/0356237/windows-7-users-you-need-sha-2-support-or-no-windows-updates-after-july-2019) and 
[zdnet.com](https://www.zdnet.com/article/windows-7-users-you-need-sha-2-support-or-no-windows-updates-after-july-2019/).

[Microsoft](https://support.microsoft.com/en-us/help/4472027/2019-sha-2-code-signing-support-requirement-for-windows-and-wsus) will update the process as the date gets closer.


# Fix multiple reinstall of win10 updates

1. run admin command prompt

```
    sfc /scannow
```

2. Check log

```
    subl  C:\Windows\Logs\CBS\CBS.log
```
    

# Backup fails with `0x8007002`

## If all else fails...

PC recommends [AOMEI Backupper](https://www.aomeitech.com/download.html)...

## Key Comments

**Note**: I could never get this to work on `crunch`. Further research suggests that
these cannot be easily restored see [this](https://lennox-it.uk/a-complete-guide-to-wbadmin-windows-backups)
article.

The problem that started all this was that my backups
would fail with a crypic error (`0x8007002`). I ultimately deleted my backups and
started a clean backup with just the `L:` drive loaded. 


## Another search

This [comment](https://social.technet.microsoft.com/Forums/en-US/6d84b1aa-956c-4216-9e56-e776e4bbf5c4/statuswait2-0x80070002-error-when-using-windows-7-style-backup-in-windows-10?forum=win10itprogeneral) from 2018-02-28 was interesting. Might be worth trying if the current attempt fails...

**The suggestion**:

Please try the following steps and check the result.

1. In `Control Panel`, open `Backup and Restore`.

2. In the `Backup` section, click `Change settings`. In the `Set up backup` dialog box, click `Next`.

3. In the **What do you want to back up** dialog box, click `Let me choose`, and then click `Next`.

4. Expand `Data Files`, expand `<your user name> Libraries`.

5. Expand `Additional` Locations, and then click to clear the `AppData` folder, `Contacts`, and `Searches` check boxes.

6. Expand `Computer`, expand the item for your system drive (for example, expand `Local Disk (C:)`), Expand `Users`, expand `<your user name>`, and then click to select the `AppData`, `Contacts`, and `Searches` check boxes if they exist. Click `Next`, and then click `Save` settings and exit.

7. In `Backup and Restore`, click `Back up now` to perform a new backup. The backup operation should complete without errors.

If the problem still persists, I suppose that there might be something wrong with your system, you may need to perform a clean install.


## Similar advice from 2009-06-11

From [here](https://social.technet.microsoft.com/Forums/windows/en-US/148b768b-4a25-4c05-a333-447a487d0a44/windows-backup-error-code-0x8100002f?forum=w7itprogeneral).

Looks like the updated locations of your folders are not getting reflected in your libraries. We will investigate on the issue. Meanwhile, as a workaround, please try the following:


1. Click on `Change backup settings` from troubleshoot dialog
2. Expand the `user node` whose libraries are getting reported as skipped.
3. Deselect the library that is causing the issue.
4. Expand the `Computer`  node in the treeview and select the redirected location of the folders. 
5. Save settings.

You should not hit the skipped files issue after this.  Hope this helps.

Thanks,
Sneha [MSFT]

## Backup in safe mode

From [www.easeus.com](https://www.easeus.com/todo-backup-resource/backup-files-in-safe-mode.html)

Lots of things can cause your system fail to boot. If you can load Windows 10/8/7 successfully, you can try Windows recovery options to restore your system back. If you cannot boot Windows normally, you should handle this situation carefully.

To prevent data loss in the process of restoring the system, you need to backup files in Safe Mode in advance. Generally, when your system is unable to boot Windows normally, you can enter Safe Mode.

However, most of the backup program will not work in Safe Mode. Luckily, no matter you are running Windows 7, Windows 8 or Windows 10, you can always use WBadmin commands to backup your computer data.

Steps to Backup Files in Safe Mode with the Help of Command Prompt

1. Start your computer, and press the F8 key repeatedly before showing the Windows logo.

2. It will lead you to Advanced Boot Options. From there, select Safe Mode with Command Prompt.

![](./png/safe-mode-with-command-prompt.png)

select safe mode with command prompt

3. Within the command prompt, you can enter a WBadmin command to backup your data. For example, if you want to backup all the data saved on C: drive to F: drive, then you can type:

```
Wbadmin start backup -backuptarget:L: -include:C:
```

If you can't boot into you cannot even boot into Safe Mode, you can still backup your files without any requirements for Windows system.


# File times on Win 7

Had some problems with incorrect file creation times for my penepma simulations.
[Superuser.com](https://superuser.com/questions/715536/wrong-date-created-for-files-in-windows-when-copying-files-if-the-file-has-alre)
recommended a registry fix. Testing now...

# Get a command prompt in a folder

From [stackoverflow](https://stackoverflow.com/questions/378319/windows-explorer-command-prompt-here/379804):

Type `cmd` to **location bar**. That's it. It will start a new command
prompt in current path. This solution was confirmed to work in Windows XP,
Vista, 7, 8 and 10 (including Creators Update).

**Shortcut** to move focus to the location bar: `Alt-D` in English, so the
quick way is `Alt-D cmd`.



# Win 10 ideas

- **To get sysinfo:** Go to the Windows Run ("Windows key + R" shortcut)
and then type `msinfo32`



# See chkdsk output

1. Run `chkdsk`. Note: on **crunch** it took a *long* time (about 20 hrs)...

2. Press the Windows + R keys to open the Run dialog, type `eventvwr.msc`,
and press Enter. If prompted by UAC, then click on Yes.

![](./png/run-eventvwr.png)

3. In the left pane of Event Viewer, double click on Windows Logs to expand it, then right click on Application and click on Find.

![](./png/ev-application-find.png)
4. The information is in the `Details area`

![](./png/chkdsk-info.png)

My most recent was:

```
Checking file system on C:
The type of the file system is NTFS.

A disk check has been scheduled.
Windows will now check the disk.                         

CHKDSK is verifying files (stage 1 of 5)...
  1194752 file records processed.                                          File verification completed.
  1449 large file records processed.                                      0 bad file records processed.                                        2 EA records processed.                                              103 reparse records processed.                                       CHKDSK is verifying indexes (stage 2 of 5)...
  1481876 index entries processed.                                         Index verification completed.
  0 unindexed files scanned.                                           0 unindexed files recovered.                                       CHKDSK is verifying security descriptors (stage 3 of 5)...
  1194752 file SDs/SIDs processed.                                         Cleaning up 819 unused index entries from index $SII of file 0x9.
Cleaning up 819 unused index entries from index $SDH of file 0x9.
Cleaning up 819 unused security descriptors.
Security descriptor verification completed.
  143563 data files processed.                                            CHKDSK is verifying Usn Journal...
  34692312 USN bytes processed.                                             Usn Journal verification completed.
CHKDSK is verifying file data (stage 4 of 5)...
  1194736 files processed.                                                 File data verification completed.
CHKDSK is verifying free space (stage 5 of 5)...
  191685679 free clusters processed.                                         Free space verification is complete.
CHKDSK discovered free space marked as allocated in the
master file table (MFT) bitmap.
CHKDSK discovered free space marked as allocated in the volume bitmap.
Windows has made corrections to the file system.

 982185983 KB total disk space.
 213715412 KB in 819720 files.
    401488 KB in 143564 indexes.
         0 KB in bad sectors.
   1326363 KB in use by the system.
     65536 KB occupied by the log file.
 766742720 KB available on disk.

      4096 bytes in each allocation unit.
 245546495 total allocation units on disk.
 191685680 allocation units available on disk.

Internal Info:
00 3b 12 00 ff b0 0e 00 0a 77 1a 00 00 00 00 00  .;.......w......
a4 06 00 00 67 00 00 00 00 00 00 00 00 00 00 00  ....g...........
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................

Windows has finished checking your disk.
Please wait while your computer restarts.

```


# Windows tips from the [Probe Software Forum](http://probesoftware.com/smf/index.php?topic=996.0)

## Easy access to command window

John Donovan noted that in Windows Explorer, when you hold the shift key
and right-click the mouse on a folder, you get this menu

![Note the **Open command window here** selection.](./png/shift-right-click-menu.png)

## An easy dated log file

Mike Matthews responded with another helpful tip:

> One tip I got told that I find particularly useful for keeping a
> maintenance log file: open a new text file and put .LOG on it's own
> on the first line. Every time you open the file thereafter the current
> date and time is automatically appended to the end of the file. Put a
> shortcut to the file on the desktop and it becomes super easy to add
> date stamped log entries as and when you need.


# Command Line Fu

## Change a drive letter from the command line.

Note this example where I change K to F

1. Start `diskpart` and list the volumes

```
> diskpart

Microsoft DiskPart version 6.1.7601
Copyright (C) 1999-2008 Microsoft Corporation.
On computer: CRUNCH

DISKPART> list volume

  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
  ----------  ---  -----------  -----  ----------  -------  ---------  --------
  Volume 0     E                       DVD-ROM         0 B  No Media
  Volume 1     C                NTFS   Partition    936 GB  Healthy    Boot
  Volume 2     D   Data         NTFS   Partition    926 GB  Healthy
  Volume 3                      FAT32  Partition    100 MB  Healthy    System
  Volume 4     L   JRM-DATA     NTFS   Partition    931 GB  Healthy
  Volume 5     K   Sneaker64    exFAT  Removable     57 GB  Healthy
  Volume 6     G                       Removable       0 B  No Media
  Volume 7     H                       Removable       0 B  No Media
  Volume 8     I                       Removable       0 B  No Media
  Volume 9     J                       Removable       0 B  No Media
```

2. Select the volume to change. Make sure the desired letter is
available. If so change it (in this case to `F`).

```
DISKPART> select volume 5

Volume 5 is the selected volume.

DISKPART> assign letter=F
```

## Create a USB Win 7 System Restore USB

From [http://www.lazesoft.com/](http://www.lazesoft.com/windows-recovery/build-a-windows-7-usb-system-repair-disc.html)

**Second Method: Manually create a Windows 7 USB bootable system**
**recovery USB flash disk**

You can also create a USB bootable system recovery USB flash disk under Windows 7. However, this process is somewhat complicated and you must burn a DVD to write a USB disk. Windows 7 cannot directly build a system recovery flash drive.

1. Open 'Backup and Restore' by clicking the Windows 7 <Start> button, clicking <Control Panel>, clicking <System and Maintenance>, and then clicking <Backup and Restore>.

2. In the left pane, click <Create a system repair disc>. (If you are prompted for an administrator password or confirmation when open the tool, type the password or provide confirmation.)

3. Select your DVD drive. Insert a blank DVD into the DVD drive and then click the <Create disc> button to start creating a bootable DVD.

4. Wait for the burning task to complete.

5. When the Windows 7 repair DVD is ready, you can now create a Windows 7 recovery USB drive. Insert your USB flash drive into your computer and backup information files on it.

6. Open 'Command Prompt' with administrator privileges. To do this, right click 'Command Prompt' and then select 'Run as administrator'. The 'Command Prompt' option is on the 'All programs -> Accessories' menu.

7. Type 'DISKPART' and press <Enter>.

8. Type 'SELECT DISK 1' and press <Enter>. (Replace '1' with your USB disk number)

9. Type 'CLEAN' and press <Enter>.

10. Type 'CREATE PARTITION PRIMARY' and press <Enter>.

11. Type 'SELECT PARTITION 1' and press <Enter>.

12. Type 'ACTIVE' and press <Enter>.

13. Type 'FORMAT FS=NTFS' and press <Enter>.

14. Type 'ASSIGN' and press <Enter>.

15. Type 'EXIT' and press <Enter>.

16. Now, copy all the files and folders (contains three items) on the previously created repair DVD to the USB flash drive. You can use your bootable USB disk now.



## Change the command line prompt.

When running git bash from a Windows command window the long default
path (the current directory) which is typically helpful



These codes are available (prompt/?)

```
  $A   & (Ampersand)
  $B   | (pipe)
  $C   ( (Left parenthesis)
  $D   Current date
  $E   Escape code (ASCII code 27)
  $F   ) (Right parenthesis)
  $G   > (greater-than sign)
  $H   Backspace (erases previous character)
  $L   < (less-than sign)
  $N   Current drive
  $P   Current drive and path
  $Q   = (equal sign)
  $S     (space)
  $T   Current time
  $V   Windows version number
```

I like prompt `$G $S` and set this in `sp.bat` in my local dir, so 
`sp` (simple prompt) works from the command line.

## Delete a directory from the command line

This will bypass Trash! Make sure the directory is not being used.
You may need to log out and back on. See the example below:

> `rd /s C:\Apps\msys64`

This was great. After removing MSYS2 with the installer, it took forever
to remove what was left behind. Would be great of old TexLive installs.

## Location of the backup drive letter in the registry

`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsBackup\ScheduleParams\TargetDevice`

## Some tips from SoftwareCarpentry and elsewhere

### Install Git

1. **Install the latest git**: Get the latest installer
[here](https://git-for-windows.github.io/). Run with the steps
below:

- Click on `Next` two times.
- Select: \
`Use a TrueType font in all console windows.`
- Click on `Next` two times.
- Select: \
`Use Git and optional Unix tools from the Windows Command Prompt` \
and click on `Next`. If you forgot to do this programs that you
need for the workshop will not work properly. If this happens rerun
the installer and select the appropriate option.
- Click on `Next`.
- Select: \
`Use Windows' default console window"` \
and click on `Next` five times.
- Click on `Install`
- Click on `Finish`.
- Download the
[win32 nano](https://www.nano-editor.org/dist/win32-support/)
`nano` executable, copy it to the
`C:\Program Files\Git\usr\bin` folder and change the name to
`nano.exe`.

2. Make sure your **HOME** environment is properly set.
- Open command prompt (Open Start Menu then type **cmd** and press [Enter])
- Type the following line into the command prompt window exactly as shown: \
`setx HOME "%USERPROFILE%"` \
You should see: \
`SUCCESS: Specified value was saved.`

- Quit command prompt by typing `exit` then pressing [Enter] \
This will provide you with both Git and Bash in the Git Bash program.

3. Add \
`C:\Program Files\Sublime Text 3` \
to your path. You will then be able to edit the python file `foo.py`
by typing \
`subl foo.py`

### Work from the command line

I tend to store source files on my network share in a sub-folder: \
`/src/sqlite` \
and on my local computer in the `Documents` folder like \
`C:/Users/userid\Documents/src/software-carpentry/2012/sql` \
Note that Windows happily accepts `/` for `\`.
These makes long paths are a pain when using the command window on
Windows when working from the command line.
It simplifies matters to work on files in `C:/tmp`




## Register an OCX file

From the directory: 

```
Regsvr32 /u foo.ocx
```

## Install or remove a program

To install:

```
  C:\> MSIEXEC /I /QB software-name.MSI
```

To remove:

```
  C:\> MSIEXEC /X /QB software-name.MSI
```

(`/QB` tells msiexec to install the app with the default options, and throw up no gui dialogs)

**N. B.:** Consider the [Chocolatey](https://chocolatey.org/) package manager.

# Win 7 and 10

## Fix the MBR on Win 10

From: [superuser.com](http://superuser.com/questions/949219/how-to-fix-windows-10-boot-loader-from-windows):

from an administrator command prompt:

```
bootsect /nt60 C: /mbr
```

## Clean Installs

Nice series from **techsupportalert.com**
[Part 1](http://www.techsupportalert.com/partitioning-hard-drives-1.htm),
[Part 2](http://www.techsupportalert.com/partitioning-hard-drives-2.htm),
and [Part 3](http://www.techsupportalert.com/partitioning-hard-drives-3.htm).

See also [pcadvisor](http://www.pcadvisor.co.uk/how-to/windows/how-reinstall-windows-reinstall-windows-10-reinstall-windows-10-3535423/).

[partition wizard](https://www.partitionwizard.com/faqvideo/how-to-build-free-bootable-partition-manager-with-pwfree91-iso.html) and dealing with the [missing os](https://www.partitionwizard.com/partitionmagic/missing-os-after-upgrading-windows-10.html) problem.


Nice detailed instructions for Win7:

1. [about.com](http://pcsupport.about.com/od/operatingsystems/ss/windows-7-clean-install-part-1.htm#step1), 

2. The [Microsoft](https://support.microsoft.com/en-us/help/15088/windows-create-installation-media) how to download installation media, esp. [Win7](https://www.microsoft.com/en-us/software-download/windows7).

3. [Barnacules](https://www.youtube.com/watch?v=k9EA4t3GHwk) video. Especially helpful because he deals with drivers needed at install time and the endless updates...

4. [The Beginner Guide](https://www.youtube.com/watch?v=-V63GbpyNqs) has nice partitioning example.

5. [HowTo Geek](http://www.howtogeek.com/172580/how-to-create-a-separate-data-partition-for-windows/) has a nice article.

6. **DIY PC Repairs** has a pair of short, videos demonstrating how to first reformat the drive and do a clean install of Win 7 and then split the drive into separate partitions. [Part 1](https://www.youtube.com/watch?v=mME9VLT7-xw) - the clean install with a single large partition. [Part 2](https://www.youtube.com/watch?v=i5_wI5YqMjI) - splitting the large partition.  


Not to mention  [How to completely clean install Windows 10 on a UEFI PC](https://petermeinl.wordpress.com/2015/09/06/how-to-really-do-a-clean-install-of-windows-10-on-a-uefi-pc/)....


Consider [DriverMax](http://www.drivermax.com/)

And the drivers for the
[ASUS CM6870](https://www.asus.com/us/support/Download/14/11/6/19/kitfFCbsOpUyO2nz/30/).
Consider unzipping them and putting the on a USB drive (**DO NOT plug it into a USB 3 port!**).


Win7 Antivirus - [AVG](http://www.avg.com/us-en/download-antivirus-for-windows)


## Locations

Start Menu Entries

```
C:\ProgramData\Microsoft\Windows\Start Menu\Programs
```

Themes

```
%USERPROFILE%\AppData\Local\Microsoft\Windows\Themes
```

Quick Launch

```
%USERPROFILE%\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch
```

Most other application configurations...

```
%USERPROFILE%\AppData\Local
```

and

```
%USERPROFILE%\AppData\Roaming
```

## Environment Variables

```
+---------------------------+------------------------------------------+
|   Environment Variable    |             Default Path                 |
+---------------------------+------------------------------------------+
| %ALLUSERSPROFILE%         | C:\ProgramData                           |
| %APPDATA%                 | C:\Users\{username}\AppData\Roaming      |
| %COMMONPROGRAMFILES%      | C:\Program Files\Common Files            |
| %COMMONPROGRAMFILES(x86)% | C:\Program Files (x86)\Common Files      |
| %COMSPEC%                 | C:\Windows\System32\cmd.exe              |
| %HOMEDRIVE%               | C:                                       |
| %HOMEPATH%                | C:\Users\{username}                      |
| %LOCALAPPDATA%            | C:\Users\{username}\AppData\Local        |
| %PROGRAMDATA%             | C:\ProgramData                           |
| %PROGRAMFILES%            | C:\Program Files                         |
| %PROGRAMFILES(X86)%       | C:\Program Files (x86) (only in 64-bit)  |
| %PUBLIC%                  | C:\Users\Public                          |
| %SystemDrive%             | C:                                       |
| %SystemRoot%              | C:\Windows                               |
| %TEMP% and %TMP%          | C:\Users\{username}\AppData\Local\Temp   |
| %USERPROFILE%             | C:\Users\{username}                      |
| %WINDIR%                  | C:\Windows                               |
+---------------------------+------------------------------------------+
```

Couldn't get the escape characters to work in Rmarkdown...

from [askvg.com](http://www.askvg.com/list-of-environment-variables-in-windows-xp-vista-and-7/)


## Turning off Cortana

According to [zdnet.com](http://www.zdnet.com/article/windows-10-tip-turn-off-cortana-completely/),
the Windows 10 Anniversary Update made it harder to turn off Cortana. Now we
heed a registry hack on Windows 10 Home.

Find (or create) the key

```
HKLM\Software\Policies\Microsoft\Windows\Windows Search
```

and set the `DWORD` value `AllowCortana` and set it to 0.


## Clear Windows Update cache

From [www.404techsupport.com](https://www.404techsupport.com/2013/01/how-to-delete-cached-windows-updates-in-windows-78/)

> To delete the downloaded updates in Windows Vista, 7, or 8, browse to C:\Windows\SoftwareDistribution\Download. (You may have to show hidden files to browse there.) Then select all the files (Ctrl+A) and delete them. Once the files are deleted, restart the computer.


## How to Install Windows 7-10 from a bootable USB

See [Barnacules youtube](https://www.youtube.com/watch?v=f4e4HujCeg8) video.

[Tool](http://wudt.codeplex.com/) referenced in video

[Alternate tool](http://www.wintobootic.com/) that works with folders and media

[Full end to end instructions](http://social.technet.microsoft.com/wiki/contents/articles/913.using-the-windows-7-usbdvd-download-tool.aspx) on obtaining image and deployment


# Win 10 stuff

## Compatibility Mode

[tenforums.com](http://www.tenforums.com/tutorials/15523-compatibility-mode-settings-apps-change-windows-10-a.html) shows where this information is stored in the registry.

[Microsoft](https://support.microsoft.com/en-us/help/15078/windows-make-older-programs-compatible) has a page designed to help. So does [howtogeek](http://www.howtogeek.com/228689/how-to-make-old-programs-work-on-windows-10/).

There is a [youtube](https://www.youtube.com/watch?v=1KNLP3T5cic) video.


It turns out that the information is stored in the registry. The key is:

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers
```

My current entries on crunch are:

```
"C:\\Apps\\GMRFilm\\GMRFILM.EXE"="WINXPSP2 RUNASADMIN"
"C:\\Program Files (x86)\\ScanSoft\\OmniPagePro12.0\\OmniPage.exe"="$ WRPMitigation"
"C:\\Program Files\\Oxford Instruments NanoAnalysis\\AZtec\\Aztec.exe"="^ WIN7RTM"
```

## Install gets stuck on 'Checking for updates'

[HT http://alinirimia.com/](http://alinirimia.com/2016/04/widows-10-install-stuck-at-checking-for-updates/) was originally from [MS]( http://answers.microsoft.com/en-us/insider/forum/insider_wintp-insider_install/window-10-install-stuck-on-checking-for-updates/e294932f-149e-412b-b996-6f1253973399?auth=1).

1. Go to Start – All Programs – Accessories – right click on Command Prompt and select "Run as administrator""
2. Type net stop wuauserv  (this will stop windows update service)
3. Wait till you get : The windows update service was stopped successfully.
4. Type net start wuauserv  (this will start windows update service)
5. Don't close the Command prompt window, you will need it later.

After that the windows setup will go from Checking for updates to Getting information on your PC and then will go to Getting updates, if you are getting stuck again (I was) repeat 1, 2, 3, 4. After that the window will ask few install questions , if you want to keep apps and data etc , after selecting the options you want it will go again at getting updates and get stuck again.   Go in command prompt and type again **net stop wuauserv** , you will notice that when you type **net start wuauserv** a message will say the service is already started, that is OK . Now the install window will complete getting updates very fast and after the window will change to Ready to install.  Press install and from now on the installer wont get stuck and complete successfully.

## privacy

[security/tips1](http://www.itpro.co.uk/operating-systems/25802/15-windows-10-problems-and-how-to-fix-them-5)

[pc-world](http://www.pcworld.com/article/2971725/windows/how-to-reclaim-your-privacy-in-windows-10-piece-by-piece.html)

[youtube - Barnacules](https://www.youtube.com/watch?v=u1kGMCfb2xw)

## tuning

[config](http://www.makeuseof.com/tag/speed-windows-10-boot-shut/)

[winaero](http://winaero.com/blog/) seems to have some good tips


### Copy a theme

1. Type `Windows-R` to run. Then enter `%localappdata%\Microsoft\Windows\Themes`

the Copy `Custom.theme` to media

## Getting a shortcut to run as an administrator.

Hat tip [cnet](http://www.cnet.com/how-to/always-run-a-program-in-administrator-mode-in-windows-10/)

![](./png/shortcut-main-menu.png) ![](./png/run-as-administrator.png) 

# Cleaning win 7

## Clearing the Win 7  Windows Update cache

[youtube](https://www.youtube.com/watch?v=5r-h5CMJp_A)

## Cleanup tool
[delete old folder](http://www.bleepingcomputer.com/tutorials/delete-windows-old-folder/)

# Connecting to Ubuntu Samba shares from Win7

From [ubuntu forums](http://ubuntuforums.org/showthread.php?t=1942514)

> I resolved my problem connecting my Windows 7 box to my Ubuntu samba (11.10). I Had the "Windows cannot access" error (0x80070035 - the network path was not found" when trying to access the server (or share). I tried a lot of things, but when it came down to what actually solved it (all other items reversed) it was the "Microsoft Network client: Digitally sign communications (always)" setting that was causing my problem. Once it was disabled, I could see the shares and map the drive.

> for the record, my "Microsoft Network client: Digitally sign communications" is set to 0 in the registry.

# Notepad++ style persistence

From [superuser.com](http://superuser.com/questions/214849/how-to-save-font-settings-in-notepad)

There are persistence problems with Notepad++ configurations on Vista/Win7

> As of v5.8.6, theme files are stored under `%PROGRAMFILES(x86)%.` Vista/Win7 will refuse to write to this directory when the application is not run as Administrator. Furthermore, it appears that "Global Override" settings get saved into the active theme file. Hopefully future versions of Notepad++ will store these user-specific theme settings under `%APPDATA%` as the Windows paradigm intends.

The solution is to `run as Administrator` for the configuration to be saved.

# Getting into `safe` mode in Win 7 on ASUS computer (`crunch`)

From [microsoft](https://social.technet.microsoft.com/forums/windows/en-US/2b8419dd-4610-4703-a807-4ef9d862bb6d/f8-does-not-take-me-into-safe-mode)

Two suggestions:

1. From H. A. V. Arinda : use `F5`

2. BF&I approach from Lany Zhang of Microsoft:

> a. Click Start, and type `msconfig` in the search box, and then press Enter.
> b. Select the Boot tab, and check the `Safe boot` in the Boot options section, and set the radio button to `Minimal`, and then click OK.
> c. Select Restart or Exit without restart in the following System Configuration prompt. Either way, the next boot will take you into safe mode.
> d. Note: Make sure you put the computer back to Normal Startup once you are done with the troubleshooting. Just open msconfig the same way as above, and then on the Boot tab uncheck the Safe boot checkbox.


# Create a shortcut to switch between windows in Win 7
Drag the shortcut from to ``%USERPROFILE%\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\Switch`` the quick launch bar.

Create a similar shortcut of the character map ``%windir%\system32\charmap.exe``

# Use Imagemagick to convert png to pdf from the command line
```
convert sample.png sample.pdf
```
Note: for high resolution (default is 72 dpi) one can add

```
-density 300
```

From [Stackoverflow](http://unix.stackexchange.com/questions/42856/how-can-i-convert-a-png-to-a-pdf-in-high-quality-so-its-not-blurry-or-fuzzy)

# Win7 libraries

[microsoft's tutorial](http://windows.microsoft.com/en-us/windows7/include-folders-in-a-library)

Libraries are a new feature in Win7 that gather content from various folders.

## To include a folder in a library:

1. Open the location of the folder you want to include.
2. Right-click on the folder and select ``Include in library``'.
3. Choose from a Library in the list or create a new one. Note that the folder is linked into the library, but remains in its original location.

## To remove a folder from a library

1. In the task bar, click the ``Windows Explorer`` button.
2. Click the library in the navigation pane.
3. Click ``locations`` at the top of the window.
4. Click the folder you want to remove from the library and then the ``Remove`` button and then ``Ok``. The folder is unlinked from the library but remains in its original location.


# Net use
see [Technet](http://technet.microsoft.com/en-us/library/gg651155.aspx) also see [about.com](http://pcsupport.about.com/od/commandlinereference/p/net-use-command.htm)

## Syntax

```
net use [{<DeviceName> | *}] [\\<ComputerName>\<ShareName>[\<volume>]] [{<Password> | *}]] [/user:[<DomainName>\]<UserName] >[/user:[<DottedDomainName>\]<UserName>] [/user: [<UserName@DottedDomainName>] [/savecred] [/smartcard] [{/delete | /persistent:{yes | no}}]

net use [<DeviceName> [/home[{<Password> | *}] [/delete:{yes | no}]]

net use [/persistent:{yes | no}]
```

## Example

```
net use d:\\server\share /user:Accounts\User1
```


Here's a slightly more complicated example that you might see in a business setting.

In this net use example, I want to map my ``e:`` drive to the ``smithmark`` shared folder on ``usrsvr002``. I want to connect as another user account I have ``[/user]`` by the name of ``msmith2`` that's stored on the ``pdc01`` domain with a password of ``Ue345Ii``. I don't want to map this drive manually every time I start my computer ``[/p:yes]`` nor do I want to enter my username and password each time ``[/savecred]``.

```
net use e: \\usrsvr002\smithmark Ue345Ii /user:pdc01\msmith2 /savecred /p:yes
```

I suppose an appropriate final example of net use would be the removal ``[/delete]`` of a currently mapped drive, in this case ``p:``.

```
net use p: /delete
```



# A setup for Win7/WinXP compatibility

1. On WinXP, create ``C:\Users\userName`` for each user. Create a ``Documents`` folder there. Change ``My Documents`` to point there. This is the default for Win7. We will use this as the user's ``%HOME%`` directory on both systems.

2. Create ``git``, ``work``, and ``src`` directories in each users ``Documents``. Create a ``proj`` directory in ``work``. 

3. Place shared dlls/scripts in ``C:\Apps\local``

4. Install Apps like analySIS, R, texlive, etc that you would like to play well across systems call frequently from the system path into a folder in ``C:\Apps``. Avoid spaces in path names was much as possible. Short is good!!!

# Enabling cut/paste w mouse from cmd window

[MS Technet](http://technet.microsoft.com/en-us/magazine/ff758104.aspx) notes that one can enable copy/paste with the mouse by enabling ``QuickEdit Mode`` in the default command window properties. See also [howto geek](http://www.howtogeek.com/howto/windows-vista/copy-to-the-clipboard-from-the-windows-command-prompt/)

# Poster printing

To use the poster printer in the 8th floor site office

1. **Queue:** ``\\rocps003\PLT4022``
2. Works well with Adobe Reader. Go to ``page setup``
3. **Paper Choice** ``Oversize B0(JIS)``
4. **Paper Source:** Check before use. Typically ``Roll 1`` is satin, ``Roll 2`` is glossy.
5. Make sure you choose best quality - it is slow; typically takes 20 min for a typical poster.

# Re-assigning drive letters

From [superuser.com](http://superuser.com/questions/70295/force-a-usb-device-to-use-a-certain-drive-letter?rq=1)

1. Start | Control Panel | Administrative Tools | Computer Management
2. Click on "Disk Management"
3. Select the USB drive in the list
4. Right-click and "Change Drive Letters and Paths..."
5. Assign a different, unused drive letter.

# Fixing major annoyances

## Quick Launch Bar in Win7

The [howto geek](http://www.howtogeek.com/howto/windows-7/add-the-quick-launch-bar-to-the-taskbar-in-windows-7/) shows us how...

1. Unlock taskbar
2. Create a new toolbar from the menu
3. Type in the location:

```
%appdata%\Microsoft\Internet Explorer\Quick Launch
```

It will be all the way over on the right, so you’ll want to click on the dotted lines and then drag the toolbar all the way to the left (which is slightly tricky sometimes). ***Note that you’ll need to right-click and unlock the taskbar before you can move the toolbar.***

## No context menus in Win 7
This has been a pain for a while on a few systems.
Of all the tips I found on line the instructions
from [here](http://sourceforge.net/p/sevenzip/discussion/45797/thread/838d57cb/) worked

```
1. open regedit
2. open HKEY_CLASSES_ROOT
3. open *
4. open shellex
5. open right click on ContextMenuHandlers and go to permissions
6. click on Advanced
7. check "Replace all child objects permissions with inheritable permissions form this object"
8. hit OK a few times
9. try to right click on a file and see if it shows up.
```

# Environment Variables

A pair of useful lists from
[askvg.com](http://www.askvg.com/list-of-environment-variables-in-windows-xp-vista-and-7/)

## WinXP

```
Environment Variable         Path
%ALLUSERSPROFILE%           C:\Documents and Settings\All Users
%APPDATA%                   C:\Documents and Settings\{username}\Application Data
%COMMONPROGRAMFILES%        C:\Program Files\Common Files
%COMMONPROGRAMFILES(x86)%   C:\Program Files (x86)\Common Files
%COMSPEC%                   C:\Windows\System32\cmd.exe
%HOMEDRIVE%                 C:
%HOMEPATH%                  C:\Documents and Settings\{username}
%PROGRAMFILES%              C:\Program Files
%PROGRAMFILES(X86)%         C:\Program Files (x86) (only in 64-bit version)
%SystemDrive%               C:
%SystemRoot%                C:\Windows
%TEMP% and %TMP%            C:\Documents and Settings\{username}\Local Settings\Temp
%USERPROFILE%               C:\Documents and Settings\{username}
%WINDIR%                    C:\Windows
```

## Vista and Win 7

```
Environment Variable        Path
%ALLUSERSPROFILE%           C:\ProgramData
%APPDATA%                   C:\Users\{username}\AppData\Roaming
%COMMONPROGRAMFILES%        C:\Program Files\Common Files
%COMMONPROGRAMFILES(x86)%   C:\Program Files (x86)\Common Files
%COMSPEC%                   C:\Windows\System32\cmd.exe
%HOMEDRIVE%                 C:
%HOMEPATH%                  C:\Users\{username}
%LOCALAPPDATA%              C:\Users\{username}\AppData\Local
%PROGRAMDATA%               C:\ProgramData
%PROGRAMFILES%              C:\Program Files
%PROGRAMFILES(X86)%         C:\Program Files (x86) (only in 64-bit version)
%PUBLIC%                    C:\Users\Public
%SystemDrive%               C:
%SystemRoot%                C:\Windows
%TEMP% and %TMP%            C:\Users\{username}\AppData\Local\Temp
%USERPROFILE%               C:\Users\{username}
%WINDIR%	                C:\Windows
```


# Win32


## Getting short path names

This one had me ripping my hair out. The solution was
[here](http://answers.google.com/answers/threadview/id/522710.html)


There's a simple way to do it on Win XP:

run ``cmd.exe`` and do the following:
```
cd "long path name"
command
```
Then ``command.com`` will come up and display the short path name.

Note that this will not work on Win7 x64. But one can do this
instead, for example:

```
C:\Program Files>cd c:\
c:\>dir /X
```

Note the fifth column returns the short name

```
 Directory of c:\

11/06/2013  01:00 PM    <DIR>          140260~1     140260dea5eb814742d2cc928a
01/06/2015  08:21 AM    <DIR>                       Apps
12/09/2014  08:54 AM    <DIR>                       Data
08/20/2014  07:14 AM               449              Desktop.lnk
03/05/2014  11:33 AM    <DIR>                       EDAX32
11/06/2013  08:28 AM               353              INSTALL.LOG
12/05/2013  10:30 AM    <DIR>                       Intel
11/17/2014  02:34 PM    <DIR>                       Kip
07/13/2009  10:20 PM    <DIR>                       PerfLogs
12/09/2013  01:54 PM    <DIR>                       process
12/15/2014  08:18 AM    <DIR>          PROGRA~1     Program Files
12/19/2014  07:03 AM    <DIR>          PROGRA~2     Program Files (x86)
10/10/2014  09:19 AM    <DIR>                       Python34
01/06/2015  03:41 PM    <DIR>                       Temp
04/22/2014  08:01 AM    <DIR>          USERIM~1     UserImages
12/06/2013  08:46 AM    <DIR>                       Users
12/16/2014  01:16 PM    <DIR>                       Windows
```

For a long directory with lots of levels one would have to do this at
each level with a space ...

### Power configuration

Hints from [here](http://ss64.com/nt/powercfg.html)

The three built-in power schemes have the GUIDs listed below:

```
SCHEME_MAX = Power saver (Max power saving) 
SCHEME_BALANCED = Balanced (Typical)
SCHEME_MIN = High performance (Min power saving)
```

List all Aliases:

```
powercfg -aliases
```

Retrieve the currently active power scheme

```
Powercfg -getactivescheme
```

Set the Monitor and disc timeouts for the current Power saver scheme

```
Powercfg -Change -monitor-timeout-ac 20
Powercfg -Change -disk-timeout-ac 30
```

Enable the mouse to wake from sleep 

```
Powercfg -deviceEnableWake "Microsoft USB IntelliMouse Explorer"

```

### Database access

Database access on 64 bit systems can be a challenge. Had trouble
getting rWipeTest to run on my Win7_x64 system.

The information from [this article](https://robertoschiabel.wordpress.com/2008/02/28/windows-x64-32bit-odbc-vs-64bit-odbc/)
was interesting.

> It’s important to understand which kind of DSN you have. On an x64 system, you can create an ODBC connection(DSN) on the 32-bit side of the system or on the 64-bit side of the system.
32-bit applications will only see ODBC connections created in the 32-bit side, and 64-bits applications will only see ODBC connections from the 64-bit side. Each kind of application has is own registry.To setup DSN for 32-bit application you must use:

```
%WINDIR%\SysWOW64\odbcad32.exe
```

and for 64-bit application you must use:

```
%WINDIR%\System32\odbcad32.exe
```

> There is not 32-bit edition of Windows XP on the XP Pro x64 media.
> http://support.microsoft.com/kb/942976/en-us

> A 64-bit version of the Microsoft Windows operating system includes the following versions of the Microsoft Open Database Connectivity (ODBC) Data Source Administrator tool (Odbcad32.exe):
- The 32-bit version of the Odbcad32.exe file is located in the %systemdrive%WindowsSysWoW64 folder.
-	The 64-bit version of the Odbcad32.exe file is located in the %systemdrive%WindowsSystem32 folder.
The Odbcad32.exe file displays the following types of data source names (DSNs):
-	System DSNs
-	User DSNs


[Back to Index](../README.html)

