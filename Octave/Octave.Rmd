---
title: "Octave Tips"
author: "J. R. Minter"
date: 'Started: 2019-03-21, Last modified: 2019-04-12'
output:
  html_document:
    css: ../theme/jm-gray-vignette.css
    number_sections: yes
    toc: yes
    toc_depth: 3
---

[Back to Index](../README.html)

# Introduction

Gnu Octave is an Open Source program similar to Matlab.
Binaries are available [here](https://www.gnu.org/software/octave/).

There is a version that runs from the command line and a GUI version.

As of 2019-03-21, the current release is `Octave 5.1.0.0` which was
released on 2019-03-01.

On the Mac, we install via Homebrew. This installs `Octave 4.4.1`.

Developer MacOSX App downloads are available
[**here**](http://octave-app.org/Developer-Downloads.html).

There is extensive documentation
[online](https://octave.org/doc/interpreter/index.html#SEC_Contents).

## Using Octave in Rmarkdown

### Code chunks must be self-contained

We need to set the path to the Octave executable to run Octave chunks
in Rmarkdown. **_N.B._ Octave code chunks must be _self-contained_**
**unlike** R code chunks.

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
octaveExe <- Sys.getenv("OCTAVE_EXECUTABLE")
octaveExe
```

### Setting up for working with opertors

1. element by element operators are the operator with a preceeding `.`.
For example:

    ```{octave elem_by_elem, engine.path=octaveExe}
    A = [1,2,3,4];
    B = [2,4,6,8];

    A .* B
    A .+ B
    A .^ B
    ```

2. We can set row and column vectors and matrices

    ```{octave row_col_vec_mat, engine.path=octaveExe}
    A = [1 2 3 4]
    B = [2;4;6;8]
    C = [1 2 3 4;5 6 7 8;9 10 11 12]
    ```



## Tutorials

1. A series on YouTube by
[DrapsTV](https://www.youtube.com/watch?v=X0xLTKRWPgo&list=PL1A2CSdiySGJ6oZe6XB-TTCFuHc5Fs1PO)
from 2014. Decent...

## Setup for the command line version

1. Set a custom prompt.

    ```
    PS1("\# > ")
    ```

    gives a simple command line, although the standard prompt
    is reasonable:
    
    ```
    octave:1> 
    ```
    
2. Clear the screen

    ```
    octave:1> clc 
    ``` 

## Getting the path right

1. Run `addpath ("~/Octave")` to add an Octave folder for functions

2. Save the path with `savepath ()`. This will write to `~/.octaverc`.


## Install packages from Octave Forge

```
pkg install -forge image
```

## Publish

Octave has a nice `publish` feature. To publish the `pub_example.m`
file, one would enter from the command line (in the correct directory...)

> publish("pub_example.m");

This creates a nice HTML file with a notebook-like format.

## PDF output from jupyter notebook w/ Octave kernel

This does not work automatically. I found a workaround
[here](https://nbconvert.readthedocs.io/en/latest).

0. Install what we need from python

    See the
    [installation section](https://nbconvert.readthedocs.io/en/latest/install.html).

    ```
    conda install nbconvert
    conda install pandoc
    ```

1. use as a command line tool

    See the
    [useage section](https://nbconvert.readthedocs.io/en/latest/usage.html).

    ```
    jupyter nbconvert --to latex notebook.ipynb
    ```

2. Use LaTeX to render the notebook. `TeXworks` worked fine...

   In general, I am pleased with the rendering...
   
   There are items to add to the .tex file
   
       Under `\title{}` (perhaps change):
       \title{Octave \textit{Vade Mecum}}
       \author{Mike James (Modified by J. R. Minter)}
       \date{2019-03-25}

# Using Octave with Rmarkdown

RStudio's `Rmarkdown` supports code chunks in languages other than `R`,
including `Octave`! Here are the details in how I configured it on both
MacOS and Windows.

On `crunch`, I set the environment variable `OCTAVE_EXECUTABLE` to:

```
C:/Apps/Octave-5.1.0.0/mingw64/bin/octave-cli-5.1.0.exe
```

On `jrmFastMac`, I set `OCTAVE_EXECUTABLE` to:

```
/usr/local/bin/octave
```

in Renviron in the `jrm_dotfiles` git repository. This
is symlinked to `.Renviron`

Here is an example code chunk. Since I don't want this to execute
here, note that the configurarion has been moved to inside the
block of triple backticks...

```
{octave, engine.path=octavePath}
   A=[1,2,3;4,5,6]
   [minval, row] = min(min(A,[],2));
   [minval, col] = min(min(A,[],1));
   [minval, row, col]

```


# Min and Max value for a matrix

This is n annoyance... Adapted from
[here](https://gist.github.com/Atlas7/6e03676da65bf467cb22d1ca42f20695).

1. Octave matrix indices start with `1` not `0`.

2. To find the minum value of the matrix and its index, one can use
   this function of the matrix `A`:
  
   ```
   A=[1,2,3;4,5,6]
   [minval, row] = min(min(A,[],2));
   [minval, col] = min(min(A,[],1));
   [minval, row, col]
   ```
   
   and for the maximum value:
   
   ```
   A=[1,2,3;4,5,6]
   [maxval, row] = max(max(A,[],2));
   [maxval, col] = max(max(A,[],1));
   [maxval, row, col]
   ```

   I coded these into functions: `max_val_pos` and `min_val_pos`. 
   
   **Note:** These are maintained under version control (`git`) in the
   `global` respository in the `octave/functions` folder.

# Functions

I struggled until I discovered one can have **only one function per .m file**...

1. Run `addpath("~/Octave")` and put functions there...
2. savepath () to save to above
3. Functions must be in **individual** files with extension `.m`
4. Test the path with `path()`


# FFTs

There is a video tutorial by Ashwith Rego (2012-11-28) on
[YouTube](https://www.youtube.com/watch?v=XofmaKJ8RnA).

There is a decent tutorial
[here](https://matlabgeeks.com/tips-tutorials/how-to-do-a-2-d-fourier-transform-in-matlab/).

# Using Octave in Jupyter Notebook.

This is **awesome**!

See: [Calysto's](https://github.com/Calysto/octave_kernel) Readme.rst file
for installation instructions.

- To install via conda:

   ```
   conda config --add channels conda-forge
   conda install octave_kernel
   conda install texinfo # For the inline documentation (shift-tab) to appear.
   ```

- Configure for MacOS

   1. `.octaverc` contents
   
   ```
   addpath ('/Users/jrminter/octave', '-begin');
   setenv("GNUTERM","qt");
   ```
   
   2. Add to `.bash_profile`
   
   ```
   OCTAVE_EXECUTABLE="/Applications/Octave-5.1.0.app/Contents/Resources/usr/Cellar/octave-octave-app@5.1.0/5.1.0/bin/octave-5.1.0"
   export OCTAVE_EXECUTABLE
   ```
   




[Back to Index](../README.html)